{"version":3,"sources":["SelectedLayer.js","BaseLayer.js","WarningLayer.js","Warning.js","components/SelectButton.js","components/TypeDropdown.js","PossibilityLayer.js","Possibility.js","components/LayerMenu.js","Map.js","App.js","index.js"],"names":["SelectedLayer","map","onSelected","_this","this","Object","classCallCheck","addSelectedLayer","on","e","onClick","_addSelectedLayer","type","addLayer","id","source","source-layer","paint","line-color","line-width","filter","features","console","log","properties","_this$getCode","getCode","code","prefName","name","selectPref","codes","_this2","forEach","l","setFilter","concat","toConsumableArray","BaseLayer","addSource","minzoom","maxzoom","tiles","selectedLayer","warningColor","none","advisory","warning","emergency","WarningLayer","data","hover","html","queryRenderedFeatures","point","layers","layerId","getCanvas","style","cursor","length","city","cities","warnings","warningLabel","join","popup","setLngLat","lngLat","setHTML","addTo","remove","addMap","render","mapboxgl","Popup","closeButton","removeLayer","off","stops","push","status","renderLayer","fill","property","default","added","setPaintProperty","fill-color","fill-outline-color","kind","substr","slice","Warning","state","props","load","layer","timestamp","Date","getTime","fetch","url","mode","then","res","json","setState","Component","SelectButton","times","selected","prevProps","getTimes","react_default","a","createElement","Button","Group","inverted","className","time","i","size","key","onSelect","active","_this3","tommorow","timeDefine","def","text","pt","dayafter","datetime","getDate","hours","parseInt","duration","replace","from","toH","getHours","TypeDropdown","value","handleChange","_ref","types","Menu","compact","Dropdown","options","onChange","item","all","rain","snow","wind","wave","PossibilityLayer","info","areas","index","renderAll","_this$selected","length1","render1","render2","renderAllType","rank","getColor","getRank","areas1","areas2","prefCode","area","p1","possibility","find","p","p2","getMaxRank","possibilityAll","undefined","高","中","ranks","includes","Possibility","onSelectDatetime","selectDatetime","onSelectType","selectType","Fragment","SelectButton_SelectButton","TypeDropdown_TypeDropdown","LayerMenu","handleItemClick","findIndex","init","icon","vertical","Item","Icon","accessToken","component","Map","layerIndex","selectLayer","container","mapContainer","zoom","center","hash","attributionControl","base","child","onload","ref","el","LayerMenu_LayerMenu","_this4","React","App","Map_Map","ReactDOM","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.76081b73.chunk.js","sourcesContent":["export default class SelectedLayer {\n  constructor(map, onSelected) {\n    this.map = map;\n    this.onSelected = onSelected;\n\n    this.addSelectedLayer();\n    this.map.on('click', 'weather-info-pref', (e) => {\n      this.onClick(e);\n    });\n  }\n\n  addSelectedLayer() {\n    this._addSelectedLayer('pref');\n    this._addSelectedLayer('distlict');\n  }\n  \n  _addSelectedLayer(type) {\n    this.map.addLayer({\n      \"id\": type + \"-line-selected\",\n      \"type\": \"line\",\n      \"source\": \"vt\",\n      \"source-layer\": type,\n      \"paint\": {\n        \"line-color\": \"rgba(70, 171, 199, 0.8)\",\n        \"line-width\": 1\n      },\n      filter: [\"==\", \"code\", \"0\"]\n    });\n  }\n\n  onClick(e) {\n    if (e.features) {\n      console.log(e.features[0].properties);\n      const { code, name } = this.getCode(e.features[0].properties.code);\n      const prefName = name || e.features[0].properties.name;\n      this.selectPref(code);\n      this.onSelected(code, prefName);\n    }\n  }\n  \n  select(type, codes) {\n    ['pref', 'distlict', 'region'].forEach(l => {\n      const filter = l === type ? codes : ['0'];\n      this.map.setFilter(l + '-line-selected', ['in', 'code', ...filter]);\n    });\n  }\n}\n","import mapboxgl from 'mapbox-gl';\n\nimport SelectedLayer from './SelectedLayer';\n\n\nexport default class BaseLayer {\n  constructor(map) {\n    this.map = map;\n    this.map.addSource(\"vt\", {\n      \"type\": \"vector\",\n      \"minzoom\": 0,\n      \"maxzoom\": 10,\n      \"tiles\": [\"https://weatherbox.github.io/warning-area-vt/v2/{z}/{x}/{y}.pbf\"]\n    });\n\n    this.map.addLayer({\n      \"id\": \"pref-line\",\n      \"type\": \"line\",\n      \"source\": \"vt\",\n      \"source-layer\": \"pref\",\n      \"paint\": {\n        \"line-color\": \"rgba(70, 70, 70, 0.4)\"\n      }\n    });\n\n    this.selectedLayer = new SelectedLayer(this.map);\n  }\n}\n","import mapboxgl from 'mapbox-gl';\n\nconst warningColor = {\n  none:      \"rgba(0, 0, 0, 0)\",\n  advisory:  \"rgba(248, 220, 37, 0.56)\",\n  warning:   \"rgba(246, 19, 19, 0.58)\",\n  emergency: \"rgba(105, 66, 179, 0.6)\",\n};\n\nexport default class WarningLayer {\n  constructor(map, data, onSelected) {\n    this.map = map;\n    this.data = data;\n    this.onSelected = onSelected;\n    this.layerId = 'warning';\n\n    this.addMap();\n  }\n\n  addMap() {\n    this.render();\n\n    this.popup = new mapboxgl.Popup({\n      closeButton: false\n    });\n    this.map.on('mousemove', this.hover);\n  }\n\n  remove() {\n    this.map.removeLayer(this.layerId);\n    this.map.off('mousemove', this.hover);\n    this.popup.remove();\n  }\n\n  // \n  render() {\n    const stops = [];\n    for (let code in this.data.cities) {\n      const city = this.data.cities[code];\n      stops.push([code, warningColor[city.status]]);\n    }\n    this.renderLayer(stops);\n  }\n\n\n  renderLayer(stops) {\n    const fill = stops.length ? {\n      \"property\": \"code\",\n      \"type\": \"categorical\",\n      \"stops\": stops,\n      \"default\": \"rgba(0, 0, 0, 0)\"\n    } : 'rgba(0, 0, 0, 0)';\n\n    if (!this.added) {\n      this.map.addLayer({\n        \"id\": this.layerId,\n        \"type\": \"fill\",\n        \"source\": \"vt\",\n        \"source-layer\": \"city\",\n        \"paint\": {\n          \"fill-color\": fill,\n          \"fill-outline-color\": \"rgba(55, 55, 55, 0.4)\"\n        }\n      }, 'pref-line');\n      this.added = true;\n    } else {\n      this.map.setPaintProperty(this.layerId, 'fill-color', fill);\n    }\n  }\n\n\n\n  hover = (e) => {\n    const features = this.map.queryRenderedFeatures(e.point, { layers: [this.layerId] });\n    this.map.getCanvas().style.cursor = (features.length) ? 'crosshair' : '';\n\n    let html;\n    if (features.length) {\n      const code = features[0].properties.code;\n      const city = this.data.cities[code]\n      if (city && city.warnings.length) {\n        html = city.name + '&emsp;';\n        html += city.warnings.map(this.warningLabel).join('');\n      }\n    }\n    \n    if (html) {\n      this.popup.setLngLat(e.lngLat)\n        .setHTML(html)\n        .addTo(this.map);\n    } else {\n      this.popup.remove();\n    }\n  }\n  \n  warningLabel(kind) {\n\t\tif (kind.substr(-3) === '注意報'){\n\t\t\treturn '<a class=\"ui label advisory\">' + kind.slice(0, -3) + '</a>';\n\t\t}else if (kind.substr(-4) === '特別警報'){\n\t\t\treturn '<a class=\"ui label emergency\">' + kind.slice(0, -4) + '</a>';\n\t\t}else if (kind.substr(-2) === '警報'){\n\t\t\treturn '<a class=\"ui label warning\">' + kind.slice(0, -2) + '</a>';\n\t\t}\n\t}\n}\n","import { Component } from 'react';\n\n//import Sidebar from './Sidebar';\nimport WarningLayer from './WarningLayer';\n\nconst url = 'https://storage.googleapis.com/weather-warning/warning.json';\n\nexport default class Warning extends Component {\n  state = {\n    data: null,\n  };\n\n  componentDidMount() {\n    this.map = this.props.map;\n    this.load();\n  }\n\n  componentWillUnmount() {\n    this.layer.remove();\n  }\n\n  onload(map) {\n    this.map = map;\n    this.addLayer();\n  }\n  \n  load() {\n    const timestamp = new Date().getTime();\n    fetch(url + '?' + timestamp, {mode: 'cors'})\n      .then(res => res.json())\n      .then(data => {\n        console.log(data);\n        this.setState({ data });\n        this.data = data;\n        this.addLayer();\n      });\n  }\n\n  addLayer() {\n    if (!this.map || !this.data) return;\n    this.layer = new WarningLayer(this.map, this.data, this.onSelected);\n  }\n\n  render() {\n    return null;\n    /*\n    return (\n      <Sidebar\n        data={this.state.info}\n        ref={el => this.sidebar = el}\n      />\n    );\n    */\n  }\n}\n","import React, { Component } from 'react';\nimport { Button } from 'semantic-ui-react';\n\nimport './SelectButton.css';\n\nexport default class SelectButton extends Component {\n  state = { times: null, selected: 0 };\n\n  componentDidUpdate(prevProps) {\n    if (this.props.data !== prevProps.data) {\n      const times = this.getTimes();\n      this.setState({ times });\n    }\n  }\n\n  render() {\n    if (!this.state.times) return null;\n    return (\n      <Button.Group inverted className=\"select-button\">\n        {this.state.times.map((time, i) => (\n          <Button\n            inverted size=\"small\"\n            key={i}\n            onClick={() => this.onSelect(i)}\n            active={i === this.state.selected}\n          >\n            {time}\n          </Button>\n        ))}:\n      </Button.Group>\n    );\n  }\n\n  onSelect(i) {\n    this.setState({ selected: i });\n    this.props.onSelect(i);\n  }\n\n  getTimes() {\n    const times = ['すべて'];\n\n    this.props.data.tommorow.timeDefine.forEach(def => {\n      const text = this.pt(def);\n      times.push(text);\n    });\n\n    this.props.data.dayafter.timeDefine.forEach(def => {\n      times.push(new Date(def.datetime).getDate() + '日');\n    });\n\n    return times;\n  }\n\n  pt(def) {\n    const hours = parseInt(def.duration.substr(2).replace('H', ''));\n    const from = new Date(def.datetime);\n    const to = new Date(from.getTime() + hours * 3600 * 1000);\n    const toH = to.getHours() || 24;\n    return `${from.getDate()}日${from.getHours()}-${toH}`;\n  }\n}\n","import React, { Component } from 'react';\nimport { Dropdown, Menu } from 'semantic-ui-react';\n\nimport './TypeDropdown.css';\n\nexport default class TypeDropdown extends Component {\n  state = { value: 'all' };\n\n  handleChange = (e, { value }) => {\n    this.setState({ value });\n    this.props.onSelect(value);\n  }\n\n  types = [\n    { key: 0, text: 'すべて', value: 'all' },\n    { key: 1, text: '大雨', value: 'rain' },\n    { key: 2, text: '暴風', value: 'wind' },\n    { key: 3, text: '波浪', value: 'wave' },\n    { key: 4, text: '大雪', value: 'snow' },\n  ];\n\n  render() {\n    return (\n      <Menu compact inverted className=\"type-dropdown\">\n        <Dropdown\n          options={this.types}\n          value={this.state.value}\n          onChange={this.handleChange}\n          item\n        />\n      </Menu>\n    );\n  }\n}\n","import mapboxgl from 'mapbox-gl';\n\nconst types = {\n  all: 'all',\n  rain: '雨',\n  snow: '雪',\n  wind: '風（風雪）',\n  wave: '波',\n};\n\n\nexport default class PossibilityLayer {\n  constructor(map, data, onSelected) {\n    this.map = map;\n    this.data = data;\n\n    this.selected = {\n      index: 0,\n      type: 'all',\n    };\n    this.layerId = 'possibility';\n\n    this.renderAll();\n\n    this.popup = new mapboxgl.Popup({\n      closeButton: false\n    });\n    this.map.on('mousemove', this.hover);\n  }\n\n  remove() {\n    this.map.removeLayer(this.layerId);\n    this.map.off('mousemove', this.hover);\n    this.popup.remove();\n  }\n\n  // UI API\n\n  selectDatetime(index) {\n    this.selected.index = index;\n    this.render();\n  }\n\n  selectType(type) {\n    this.selected.type = types[type];\n    this.render();\n  }\n\n\n  // \n  render() {\n    const { index, type } = this.selected;\n    const length1 = this.data.tommorow.timeDefine.length;\n    if (index === 0) {\n      this.renderAll(type);\n\n    } else if (index <= length1) {\n      this.render1(type, index - 1);\n    } else {\n      this.render2(type, index - length1 - 1);\n    }\n  }\n\n  renderAll(type) {\n    if (type && type !== 'all') return this.renderAllType(type);\n    const stops = [];\n\n    for (let code in this.data.all) {\n      const rank = this.data.all[code];\n      if (rank) stops.push([code, this.getColor(rank)]);\n    }\n    this.renderLayer(stops);\n  }\n\n  render1(type, index) {\n    const areas = this.data.tommorow.areas;\n    const stops = [];\n\n    for (let code in areas) {\n      const rank = this.getRank(areas[code], type, index);\n      if (rank) stops.push([code, this.getColor(rank)]);\n    }\n    this.renderLayer(stops);\n  }\n  \n  render2(type, index) {\n    const areas1 = this.data.tommorow.areas;\n    const areas2 = this.data.dayafter.areas;\n    const stops = [];\n\n    for (let code in areas1) {\n      const prefCode = areas1[code].area.prefCode;\n      const rank = this.getRank(areas2[prefCode], type, index);\n      if (rank) stops.push([code, this.getColor(rank)]);\n    }\n    this.renderLayer(stops);\n  }\n\n  renderAllType(type) {\n    const areas1 = this.data.tommorow.areas;\n    const areas2 = this.data.dayafter.areas;\n    const stops = [];\n\n    for (let code in areas1) {\n      const prefCode = areas1[code].area.prefCode;\n      const p1 = areas1[code].possibility.find(p => p.type === type) || {};\n      const p2 = areas2[prefCode].possibility.find(p => p.type === type) || {};\n      const rank = this.getMaxRank([].concat(p1.rank, p2.rank));\n      if (rank) stops.push([code, this.getColor(rank)]);\n    }\n    this.renderLayer(stops);\n\n  }\n\n  getRank(area, type, index) {\n    if (type === 'all') {\n      return area.possibilityAll[index];\n\n    } else {\n      const p = area.possibility.find(p => p.type === type);\n      return p ? p.rank[index] : undefined;\n    }\n  }\n\n  renderLayer(stops) {\n    const fill = stops.length ? {\n      \"property\": \"code\",\n      \"type\": \"categorical\",\n      \"stops\": stops,\n      \"default\": \"rgba(0, 0, 0, 0)\"\n    } : 'rgba(0, 0, 0, 0)';\n\n    if (!this.added) {\n      this.map.addLayer({\n        \"id\": this.layerId,\n        \"type\": \"fill\",\n        \"source\": \"vt\",\n        \"source-layer\": \"distlict\",\n        \"paint\": {\n          \"fill-color\": fill,\n          \"fill-outline-color\": \"rgba(55, 55, 55, 0.4)\"\n        }\n      }, 'pref-line');\n      this.added = true;\n    } else {\n      this.map.setPaintProperty(this.layerId, 'fill-color', fill);\n    }\n  }\n\n\n  getColor(rank) {\n    const colors = {\n      '高': 'rgba(253, 108, 112, 0.5)',\n      '中':  'rgba(253, 188, 172, 0.4)'\n    };\n    return colors[rank];\n  }\n\n  getMaxRank(ranks) {\n    if (ranks.includes('高')) return '高'; \n    if (ranks.includes('中')) return '中';\n    return null;\n  }\n\n  hover = (e) => {\n    const features = this.map.queryRenderedFeatures(e.point, { layers: [this.layerId] });\n    this.map.getCanvas().style.cursor = (features.length) ? 'crosshair' : '';\n\n    let html;\n    if (features.length) {\n      const code = features[0].properties.code; \n      const info = this.data.tommorow.areas[code];\n      if (info) {\n        html = info.text;\n      }\n    }\n    \n    if (html) {\n      this.popup.setLngLat(e.lngLat)\n        .setHTML(html)\n        .addTo(this.map);\n    } else {\n      this.popup.remove();\n    }\n  }\n  \n}\n","import React, { Component } from 'react';\n\n//import Sidebar from './Sidebar';\nimport SelectButton from './components/SelectButton';\nimport TypeDropdown from './components/TypeDropdown';\nimport PossibilityLayer from './PossibilityLayer';\n\nconst url = 'https://storage.googleapis.com/weather-warning/possibility.json';\n\nexport default class Possibility extends Component {\n  state = {\n    data: null,\n  };\n\n  componentDidMount() {\n    this.map = this.props.map;\n    this.load();\n  }\n  \n  componentWillUnmount() {\n    this.layer.remove();\n  }\n\n  onload(map) {\n    this.map = map;\n    this.addLayer();\n  }\n  \n  load() {\n    const timestamp = new Date().getTime();\n    fetch(url + '?' + timestamp, {mode: 'cors'})\n      .then(res => res.json())\n      .then(data => {\n        console.log(data);\n        this.setState({ data });\n        this.data = data;\n        this.addLayer();\n      });\n  }\n\n  addLayer() {\n    if (!this.map || !this.data) return;\n    this.layer = new PossibilityLayer(this.map, this.data, this.onSelected);\n  }\n\n  render() {\n    return <>\n      <SelectButton\n        data={this.state.data}\n        onSelect={this.onSelectDatetime} />\n      <TypeDropdown\n        onSelect={this.onSelectType} />\n    </>;\n    /*\n    return (\n      <Sidebar\n        data={this.state.info}\n        ref={el => this.sidebar = el}\n      />\n    );\n    */\n  }\n\n  onSelectDatetime = (index) => {\n    this.layer.selectDatetime(index);\n  }\n\n  onSelectType = (type) => {\n    this.layer.selectType(type);\n  }\n}\n","import React, { Component } from 'react'\nimport { Icon, Menu } from 'semantic-ui-react'\n\nimport './LayerMenu.css';\n\n\nexport default class LayerMenu extends Component {\n  state = { active: 0 }\n\n  componentDidMount() {\n    this.setState({ active: this.props.init });\n  }\n\n  handleItemClick = (e, { id }) => {\n    const active = this.props.layers.findIndex(l => l.id === id);\n    this.setState({ active });\n    this.props.onSelect(active);\n  }\n\n  render() {\n    const { active } = this.state\n\n    return (\n      <Menu icon vertical inverted id=\"layer-menu\">\n        {this.props.layers.map((l, i) => (\n          <Menu.Item\n            key={i}\n            id={l.id}\n            name={l.name}\n            active={active === i}\n            onClick={this.handleItemClick}\n          >\n            <Icon name={l.icon} />\n          </Menu.Item>\n        ))}\n      </Menu>\n    )\n  }\n}\n","import React, { Component } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport 'mapbox-gl/dist/mapbox-gl.css'\n\nimport BaseLayer from './BaseLayer';\nimport Warning from './Warning';\nimport Possibility from './Possibility';\nimport './Map.css';\n\nimport LayerMenu from './components/LayerMenu';\n\nmapboxgl.accessToken = 'pk.eyJ1IjoidGF0dGlpIiwiYSI6ImNqZWZ4eWM3NTI2cGszM2xpYXEyZndpd3IifQ.ifzbR45HecVGxChbdR2hiw';\n\nconst layers = [\n  {\n    id: 'warning',\n    component: Warning,\n    name: '気象警報・注意報',\n    icon: 'warning sign'\n  },\n  {\n    id: 'possibility',\n    component: Possibility,\n    name: '警報級の可能性',\n    icon: 'calendar alternate outline'\n  },\n];\n\n\nexport default class Map extends Component {\n  state = { layerIndex: 1 };\n\n  componentDidMount() {\n    this.map = new mapboxgl.Map({\n      container: this.mapContainer,\n      style: 'mapbox://styles/tattii/cj1bob6hw003t2rr5s2svi3iq',\n      zoom: 4.2,\n      center: [136.6 + 10, 35.5],\n      hash: true,\n      attributionControl: false\n    });\n\n    this.map.on('load', () => {\n      this.base = new BaseLayer(this.map);\n      this.child.onload(this.map);\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"app\">\n        <div ref={el => this.mapContainer = el} id=\"map\" />\n\n        {this.renderLayer()}\n\n        <LayerMenu\n          layers={layers}\n          init={this.state.layerIndex}\n          onSelect={this.selectLayer}\n        />\n      </div>\n    )\n  }\n\n  renderLayer() {\n    const props = {\n      map: this.map,\n      ref: ref => this.child = ref,\n    };\n    return React.createElement(layers[this.state.layerIndex].component, props);\n  }\n\n  selectLayer = (index) => {\n    this.setState({ layerIndex: index });\n  }\n}\n","import React, { Component } from 'react';\n\nimport Map from './Map';\n\nclass App extends Component {\n  render() {\n    return (\n      <Map />\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('app'));\n\n"],"sourceRoot":""}