(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){e.exports=n(21)},15:function(e,t,n){},19:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(8),i=n.n(o),c=(n(15),n(1)),s=n(2),u=n(5),l=n(4),f=n(3),p=n(6),d=n.n(p),h=(n(17),n(9)),y=function(){function e(t,n){var r=this;Object(c.a)(this,e),this.map=t,this.onSelected=n,this.addSelectedLayer(),this.map.on("click","weather-info-pref",function(e){r.onClick(e)})}return Object(s.a)(e,[{key:"addSelectedLayer",value:function(){this._addSelectedLayer("pref"),this._addSelectedLayer("distlict"),this._addSelectedLayer("region")}},{key:"_addSelectedLayer",value:function(e){this.map.addLayer({id:e+"-line-selected",type:"line",source:"region"===e?"region-vt":"vt","source-layer":e,paint:{"line-color":"rgba(70, 171, 199, 0.8)","line-width":1},filter:["==","code","0"]})}},{key:"onClick",value:function(e){if(e.features){console.log(e.features[0].properties);var t=this.getCode(e.features[0].properties.code),n=t.code,r=t.name||e.features[0].properties.name;this.selectPref(n),this.onSelected(n,r)}}},{key:"select",value:function(e,t){var n=this;["pref","distlict","region"].forEach(function(r){var a=r===e?t:["0"];n.map.setFilter(r+"-line-selected",["in","code"].concat(Object(h.a)(a)))})}}]),e}(),v=function(){function e(t,n,r){var a=this;Object(c.a)(this,e),this.hover=function(e){var t=a.map.queryRenderedFeatures(e.point,{layers:[]});if(a.map.getCanvas().style.cursor=t.length?"crosshair":"",t.length){var n=a.getCode(t[0].properties.code);a.weatherInfo.prefs[n]}a.popup.remove()},this.map=t,this.data=n,this.map.addSource("vt",{type:"vector",minzoom:0,maxzoom:10,tiles:["https://weatherbox.github.io/warning-area-vt/v2/{z}/{x}/{y}.pbf"]}),this.map.addLayer({id:"pref-line",type:"line",source:"vt","source-layer":"pref",paint:{"line-color":"rgba(55, 55, 55, 0.4)"}}),this.renderAll(),this.selectedLayer=new y(t,r),this.popup=new d.a.Popup({closeButton:!1}),this.map.on("mousemove",this.hover)}return Object(s.a)(e,[{key:"renderAll",value:function(){var e=[];for(var t in this.data.all){var n=this.data.all[t];n&&e.push([t,this.getColor(n)])}this.map.addLayer({id:"possibility-all",type:"fill",source:"vt","source-layer":"distlict",paint:{"fill-color":{property:"code",type:"categorical",stops:e,default:"rgba(0, 0, 0, 0)"}}})}},{key:"getColor",value:function(e){return{"\u9ad8":"rgba(253, 108, 112, 0.5)","\u4e2d":"rgba(253, 188, 172, 0.4)"}[e]}}]),e}();function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var b=function(e){Object(u.a)(n,e);var t=m(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={info:null},e.onSelected=function(t,n){e.sidebar.showPref(t,n)},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.loadWeatherInfo()}},{key:"onload",value:function(e){this.map=e,this.addLayer()}},{key:"loadWeatherInfo",value:function(){var e=this,t=(new Date).getTime();fetch("https://storage.googleapis.com/weather-warning/possibility.json?"+t,{mode:"cors"}).then(function(e){return e.json()}).then(function(t){console.log(t),e.setState({info:t}),e.data=t,e.addLayer()})}},{key:"addLayer",value:function(){this.map&&this.data&&(this.layer=new v(this.map,this.data,this.onSelected))}},{key:"render",value:function(){return null}}]),n}(r.Component);n(19);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}d.a.accessToken="pk.eyJ1IjoidGF0dGlpIiwiYSI6ImNqZWZ4eWM3NTI2cGszM2xpYXEyZndpd3IifQ.ifzbR45HecVGxChbdR2hiw";var j=function(e){Object(u.a)(n,e);var t=g(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.map=new d.a.Map({container:this.mapContainer,style:"mapbox://styles/tattii/cj1bob6hw003t2rr5s2svi3iq",zoom:4.2,center:[146.6,35.5],hash:!0,attributionControl:!1}),this.map.on("load",function(){e.child.onload(e.map)})}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"app"},a.a.createElement("div",{ref:function(t){return e.mapContainer=t},id:"map"}),a.a.createElement(b,{ref:function(t){return e.child=t}}))}}]),n}(r.Component);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var O=function(e){Object(u.a)(n,e);var t=w(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return a.a.createElement(j,null)}}]),n}(r.Component);i.a.render(a.a.createElement(O,null),document.getElementById("app"))}},[[10,2,1]]]);
//# sourceMappingURL=main.1d4620f9.chunk.js.map